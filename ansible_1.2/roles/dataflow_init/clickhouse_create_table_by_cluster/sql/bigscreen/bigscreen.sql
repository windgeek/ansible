CREATE DATABASE k19_ods;
CREATE DATABASE k19_distribute;
CREATE TABLE k19_ods.attack_conv_log_local (region String,log_id String,s_ip String,d_ip String,byte Int64,bps Int64,packets Int64,type String,is_attack_success String,s_country String,s_city String,s_geo String,d_country String,d_city String,d_geo String,time_stamp DateTime DEFAULT now()) ENGINE = MergeTree PARTITION BY toRelativeHourNum(time_stamp) ORDER BY time_stamp SETTINGS index_granularity = 8192;
CREATE TABLE k19_distribute.attack_conv_log (region String,log_id String,s_ip String,d_ip String,byte Int64,bps Int64,packets Int64,type String,is_attack_success String,s_country String,s_city String,s_geo String,d_country String,d_city String,d_geo String,time_stamp DateTime DEFAULT now()) ENGINE = Distributed(ndc_tse_ys_big_w, k19_ods, attack_conv_log_local, rand());
CREATE TABLE k19_ods.bigscreen_dm_conv_log_local ( region String,log_id String,found_time Int64,server_ip String,service_id String,lineid String,pipe_id String,vcid String,octets_in Int64,octets_out Int64,qos_dropped_octets_in Int64,qos_dropped_octets_out Int64,dp_connections Int64) ENGINE = MergeTree PARTITION BY (log_id, toRelativeHourNum(toDateTime(found_time))) ORDER BY found_time TTL toDateTime(found_time) + INTERVAL 8 DAY SETTINGS index_granularity = 8192;
CREATE TABLE k19_distribute.bigscreen_dm_conv_log (region String,log_id String,found_time Int64,server_ip String,service_id String,lineid String,pipe_id String,vcid String,octets_in Int64,octets_out Int64,qos_dropped_octets_in Int64,qos_dropped_octets_out Int64,dp_connections Int64) ENGINE = Distributed(ndc_tse_ys_big_w, k19_ods, bigscreen_dm_conv_log_local, rand());

